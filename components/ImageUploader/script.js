!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("../../components/Loading"),require("../../components/ProgressBar"),require("@square/maker-icons/Plus"),require("@square/maker-icons/X"));else if("function"==typeof define&&define.amd)define(["../../components/Loading","../../components/ProgressBar","@square/maker-icons/Plus","@square/maker-icons/X"],t);else{var s="object"==typeof exports?t(require("../../components/Loading"),require("../../components/ProgressBar"),require("@square/maker-icons/Plus"),require("@square/maker-icons/X")):t(e["../../components/Loading"],e["../../components/ProgressBar"],e["@square/maker-icons/Plus"],e["@square/maker-icons/X"]);for(var a in s)("object"==typeof exports?exports:e)[a]=s[a]}}(this,(function(e,t,s,a){return function(){"use strict";var r={175:function(t){t.exports=e},984:function(e){e.exports=t},597:function(e){e.exports=s},438:function(e){e.exports=a}},i={};function n(e){var t=i[e];if(void 0!==t)return t.exports;var s=i[e]={exports:{}};return r[e](s,s.exports,n),s.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return function(){n.r(o),n.d(o,{IMAGE_SELECTOR_STATUSES:function(){return f},MImageUploader:function(){return v}});var e=n(597),t={name:"MImagePicker",components:{PlusIcon:n.n(e)()},methods:{addImages(e){this.$emit("image-picker:add-images",[...e.target.files])}}},s={ImagePickerInputContainer:"ðŸ“š0-0-0-semantic-releasepQAz9",ImagePickerInputIcon:"ðŸ“š0-0-0-semantic-releasezAfnU",ImagePickerInput:"ðŸ“š0-0-0-semantic-releasepeBvR"};function a(e,t,s,a,r,i,n,o){var l,m="function"==typeof e?e.options:e;if(t&&(m.render=t,m.staticRenderFns=s,m._compiled=!0),a&&(m.functional=!0),i&&(m._scopeId="data-v-"+i),n?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(n)},m._ssrRegister=l):r&&(l=o?function(){r.call(this,(m.functional?this.parent:this).$root.$options.shadowRoot)}:r),l)if(m.functional){m._injectStyles=l;var g=m.render;m.render=function(e,t){return l.call(t),g(e,t)}}else{var c=m.beforeCreate;m.beforeCreate=c?[].concat(c,l):[l]}return{exports:e,options:m}}var r=a(t,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:e.$s.ImagePickerInputContainer,attrs:{role:"button",tabindex:"0"},on:{click:function(t){return e.$refs.input.click()},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.$refs.input.click())}}},[s("input",e._b({ref:"input",class:e.$s.ImagePickerInput,attrs:{type:"file"},on:{change:e.addImages}},"input",e.$attrs,!1)),e._v(" "),s("plus-icon",{class:e.$s.ImagePickerInputIcon,attrs:{inline:""}})],1)}),[],!1,(function(e){this.$s=s.locals||s}),null,null).exports,i=n(175),l=n(984),m=n(438),g=n.n(m);const c=1,u=0;var p={name:"MImageSelection",components:{MLoading:i.MLoading,MProgressBar:l.MProgressBar,XIcon:g()},props:{progress:{type:Number,default:0},url:{type:String,default:""},isUploading:{type:Boolean,default:!1},isError:{type:Boolean,default:!1}},computed:{bgImageStyle(){const e=`url("${this.url}")`;return{backgroundImage:this.showProgressBar?`linear-gradient(0deg, rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0.5)), ${e}`:`linear-gradient(180deg, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0) 50%), ${e}`,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover"}},showProgressBar(){return this.progress<100},progressContainerStyle(){return{opacity:this.showProgressBar?c:u}},progressStyle(){return{width:`${this.progress}%`}}}},d={ImageSelectionContainer:"ðŸ“š0-0-0-semantic-release_plKd",ImageSelectionLoaderContainer:"ðŸ“š0-0-0-semantic-releaseJD5kO",ImageSelectionContainerError:"ðŸ“š0-0-0-semantic-release_KEpe",ImageSelectionRemoveButton:"ðŸ“š0-0-0-semantic-releaseLjdan",ImageSelectionRemoveIcon:"ðŸ“š0-0-0-semantic-releaseqSHso",ImageSelectionProgressContainer:"ðŸ“š0-0-0-semantic-releasettMpu"};var I=a(p,(function(){var e,t=this,s=t.$createElement,a=t._self._c||s;return a("div",{class:(e={},e[t.$s.ImageSelectionContainer]=!0,e[t.$s.ImageSelectionContainerError]=t.isError,e),style:t.bgImageStyle,attrs:{role:"img"}},[t.isUploading?a("div",{class:t.$s.ImageSelectionLoaderContainer},[a("m-loading",{class:t.$s.ImageSelectionLoader})],1):t._e(),t._v(" "),a("m-progress-bar",{class:t.$s.ImageSelectionProgressContainer,style:t.progressContainerStyle,attrs:{progress:t.progress,size:"xsmall"}}),t._v(" "),t.isUploading?t._e():a("button",{class:t.$s.ImageSelectionRemoveButton,attrs:{type:"button"},on:{click:function(e){return t.$emit("removeImage")}}},[a("x-icon",{class:t.$s.ImageSelectionRemoveIcon,attrs:{inline:""}})],1)],1)}),[],!1,(function(e){this.$s=d.locals||d}),null,null).exports;const f={UPLOADING:"uploading",ERROR:"error",COMPLETE:"complete"};var h={ImageUploaderContainer:"ðŸ“š0-0-0-semantic-release_H4Zl",ImageUploaderItem:"ðŸ“š0-0-0-semantic-releaseEt600"};var v=a({name:"MImageUploader",components:{ImagePicker:r,ImageSelection:I},props:{uploadHandler:{type:Function,default:void 0},maxImages:{type:Number,default:void 0},maxSize:{type:Number,default:void 0},accept:{type:String,default:"image/*",validator:e=>e.startsWith("image/")}},data:()=>({images:[],nextID:0}),computed:{canUploadImage(){return void 0===this.maxImages||this.images.length<this.maxImages},remainingImagesCount(){return this.canUploadImage?this.maxImages-this.images.length:0},canUploadMultiple(){return!this.maxImages||this.maxImages>1}},watch:{images:{deep:!0,handler(){this.updateImages()},immediate:!0}},methods:{async addImages(e){if(!this.canUploadImage)return;const t=e.length>this.remainingImagesCount?e.slice(0,this.remainingImagesCount):e,s=await this.formatImages(t);this.images=[...this.images,...s],s.forEach((e=>this.handleImageUpload(e)))},async formatImages(e){const t=e.map((e=>(this.nextID+=1,{id:this.nextID,file:e,status:f.UPLOADING,progress:0})));return await this.buildImageURLs(t),t},async buildImageURLs(e){e.forEach((async e=>{try{const t=await new Promise(((t,s)=>{const a=new FileReader;a.onloadend=()=>t(a.result),a.onerror=s,a.readAsDataURL(e.file)}));this.$set(e,"url",t)}catch(t){this.$set(e,"fileReadError",!0),this.setImageError(e,t)}}))},async handleImageUpload(e){if(this.validateImageSize(e),this.isImageValid(e))if(this.uploadHandler)try{const t=await this.uploadHandler({imageFile:e.file,setImageProgress:t=>this.setImageProgress(e,t)});this.setImageComplete(e,t)}catch(t){this.setImageFailed(e,t)}else this.setImageComplete(e);else this.setImageFailed(e)},removeImage(e){this.images=this.images.filter((({id:t})=>t!==e))},validateImageSize(e){this.maxSize&&e.file.size>this.maxSize&&this.$set(e,"fileTooLarge",!0)},isImageValid:e=>!e.fileTooLarge&&!e.fileReadError,setImageComplete(e,t){t&&this.setImageApiResponse(e,t),this.setImageStatus(e,f.COMPLETE),this.setImageProgress(e,100)},setImageFailed(e,t){t&&this.setImageError(e,t),this.setImageStatus(e,f.ERROR),this.setImageProgress(e,100)},setImageStatus(e,t){this.$set(e,"status",t)},setImageProgress(e,t){this.$set(e,"progress",t)},setImageApiResponse(e,t){this.$set(e,"apiResponse",t)},setImageError(e,t){this.$set(e,"error",t)},imagesForStatus(e){return this.images.filter((t=>t.status===e))},sanitizeOutputImages:e=>e.map((e=>({status:e.status,file:e.file,apiResponse:e.apiResponse,error:e.error,fileTooLarge:e.fileTooLarge,fileReadError:e.fileReadError}))),updateImages(){this.$emit("image-uploader:change",this.sanitizeOutputImages(this.images)),this.$emit("image-uploader:uploading",this.sanitizeOutputImages(this.imagesForStatus(f.UPLOADING))),this.$emit("image-uploader:error",this.sanitizeOutputImages(this.imagesForStatus(f.ERROR))),this.$emit("image-uploader:complete",this.sanitizeOutputImages(this.imagesForStatus(f.COMPLETE)))},isUploadingImage:e=>e.status===f.UPLOADING,isImageWithError:e=>e.status===f.ERROR}},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:e.$s.ImageUploaderContainer},[e.canUploadImage?s("image-picker",{class:e.$s.ImageUploaderItem,attrs:{multiple:e.canUploadMultiple,accept:e.accept},on:{"image-picker:add-images":e.addImages}}):e._e(),e._v(" "),e._l(e.images,(function(t){return s("image-selection",{key:t.id,class:e.$s.ImageUploaderItem,attrs:{progress:t.progress,url:t.url,"is-uploading":e.isUploadingImage(t),"is-error":e.isImageWithError(t)},on:{removeImage:function(s){return e.removeImage(t.id)}}})}))],2)}),[],!1,(function(e){this.$s=h.locals||h}),null,null).exports}(),o}()}));
//# sourceMappingURL=script.js.map